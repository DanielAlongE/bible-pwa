<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <textarea id="result" cols="5" style="width: 100%; height: 400px;"></textarea>
    <div>
        <button id="btn-run">Run</button>
    </div>
    
    <script>

        const books = ['Genesis', 'Exodus', 'Leviticus', 'Numbers', 'Deuteronomy', 'Joshua', 'Judges', 'Ruth', '1 Samuel', '2 Samuel', '1 Kings', '2 Kings', '1 Chronicles', '2 Chronicles', 'Ezra', 'Nehemiah', 'Esther', 'Job', 'Psalms', 'Proverbs', 'Ecclesiastes', 'Song of Solomon', 'Isaiah', 'Jeremiah', 'Lamentations', 'Ezekiel', 'Daniel', 'Hosea', 'Joel', 'Amos', 'Obadiah', 'Jonah', 'Micah', 'Nahum', 'Habakkuk', 'Zephaniah', 'Haggai', 'Zechariah', 'Malachi', 'Matthew', 'Mark', 'Luke', 'John', 'Acts', 'Romans', '1 Corinthians', '2 Corinthians', 'Galatians', 'Ephesians', 'Philippians', 'Colossians', '1 Thessalonians', '2 Thessalonians', '1 Timothy', '2 Timothy', 'Titus', 'Philemon', 'Hebrews', 'James', '1 Peter', '2 Peter', '1 John', '2 John', '3 John', 'Jude', 'Revelation'];

        let text = "";
        (async function(){
            text = await fetch("../dist/kjv.txt").then(res => res.text());
            console.log("letter count ", text.length );
            //console.log("line count ", text.match(new RegExp("\n", "gm")).length )
            console.log("verses count ", text.split(new RegExp("[0-9]+:[0-9]+", "gm")).length )
            
            text = text.replace(new RegExp("([0-9]+:[0-9]+)", "gm"), "\n@$1");

            let verses = text.split(new RegExp("@([0-9]+:[0-9]+)", "gm"));
            //document.querySelector("#result").value = verses;
            /**/
            let bookIndex = -1;
            const cleanVerses = verses.map( (x,i) => {
                
                return x.replace(new RegExp("([0-9]+):([0-9]+)(.*)", "g"), function(m, chapter, verse, rest){
                    if(chapter == 1 && verse == 1){
                        bookIndex += 1;
                    }
                    console.log(chapter, verse, rest)
                    return books[bookIndex] + ` ${m}`;
                });

                //console.log( x, m )
                //console.log(books[bookIndex])
            } );

            
            document.querySelector("#result").value = cleanVerses.join("");
        })()

        function addQuotes(){
            const val = document.querySelector("#result").value;

            //
            //const k = val.replace(new RegExp("(.*)\n", "gm"), "'$1',")
            const k = val.replace(new RegExp("^([a-zA-Z0-9 ]+)$", "gm"), "'$1',").replace(new RegExp("\n", "gm"), " ")
            //console.log(k)
            document.querySelector("#result").value = k;
        }

        document.querySelector("#btn-run").addEventListener('click', function(e){
            addQuotes();
        })

        
    </script>
</body>
</html>